<div class="history-container">
    @for (item of allLeaveRequests; track $index) {
    <div style="margin-bottom: 10px;" class="accordion" [attr.id]="'req' + item.id">
        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button button-style" [class.collapsed]="!isPanelOpen('req' + item.id)"
                    (click)="togglePanel('req' + item.id)" [attr.aria-expanded]="isPanelOpen('req' + item.id)"
                    [attr.aria-controls]="'collapse-req-' + item.id">
                    <div class="col-3" style="padding: 0px; margin: 0px;">
                        <h6>Category</h6>
                        <p>Leave</p>
                    </div>
                    <div class="col-3">
                        <h6>Leave Type</h6>
                        <p>{{item?.leave_type}}</p>
                    </div>
                    <div class="col-3">
                        <h6>No. of days</h6>
                        <p>{{calculateNoOfDays(item.start_date, item.end_date)}}</p>
                    </div>
                    <div class="col-3">
                        <h6>Status</h6>
                        <p [ngClass]="{
                            'text-green': item.status === 'APPROVED',
                            'text-red': item.status === 'REJECTED',
                            'text-pending': item.status === 'PENDING'
                          }">
                            {{item.status}}
                        </p>
                    </div>
                </button>
            </h2>
            <div class="accordion-collapse collapse" [class.show]="isPanelOpen('req' + item.id)"
                [attr.id]="'collapse-req-' + item.id">
                <div class="accordion-body">
                    <div class="col-12">
                        <h6>Employee ID: <span class="span">{{item?.user_id}}</span></h6>
                        <h6>Employee Name: <span class="span">{{item?.user?.firstName}} {{item?.user?.lastName}}</span></h6>
                        <h6>Duration: <span class="span">{{item?.start_date | date: 'dd MMM yyyy'}} - {{item?.end_date | date: 'dd MMM yyyy'}}</span>
                        </h6>
                        <h6>Reason: <span class="span">{{item?.reason}}</span></h6>
                    </div>
                    @if (item?.status === 'PENDING') {
                    <div style="display: inline-flex; justify-content: flex-end; gap: 10px;" class="col-12">
                            <button (click)="handleApprove(item.id)" type="button" class="btn btn-yes">Approve</button>
                            <button (click)="handleReject(item.id)" type="button" class="btn btn-secondary">Reject</button>
                    </div>
                    }
                </div>
            </div>
        </div>
    </div>
    }
    @if (!allLeaveRequests || allLeaveRequests.length === 0) {
    <div class="col-12" style="display: flex; justify-content: center; align-items: center; padding: 2rem;">No Leave Requests Found</div>
    }
    
    <app-confirmation-modal 
    #confirmModal 
    [title]="'Confirmation'" 
    [message]="confirmationMessage"
    [confirmText]="'Yes'"
    [cancelText]="'No'" 
    (confirmed)="onConfirm()">
    </app-confirmation-modal>
</div>